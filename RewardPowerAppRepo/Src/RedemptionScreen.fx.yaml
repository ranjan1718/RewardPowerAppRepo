RedemptionScreen As screen:
    Fill: =RGBA(202, 202, 202, 1)

    HeaderContainer_1 As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(109, 49, 162, 1)
        Height: =Parent.Height/8
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutJustifyContent: =LayoutJustifyContent.End
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =1

        Icon7 As icon.Folder:
            Color: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            Icon: =Icon.AddUser
            OnSelect: =Navigate(ProfileScreen,ScreenTransition.Fade)
            Width: =If(RedemptionScreen.Size=2||RedemptionScreen.Size=3,35, 40)
            ZIndex: =1

        Label11_2 As label:
            Text: =""
            Width: =Parent.Width*0.04
            X: =(Parent.Width-Self.Width)
            ZIndex: =2

        Icon1 As icon.Home:
            Color: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height
            Icon: =Icon.BackArrow
            OnSelect: =Navigate(HomeScreen)
            Width: =If(RedemptionScreen.Size=2||RedemptionScreen.Size=3,35, 40)
            X: =(Parent.Width-Self.Width)
            Y: =(Parent.Height-Self.Height)/2
            ZIndex: =3

    ImageContainer_2 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =Parent.Height/8
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width*0.24
        ZIndex: =2

        Image1_2 As image:
            Height: =Switch(RedemptionScreen.Size,1,Parent.Height*0.5,2,Parent.Height*0.6,3,Parent.Height*0.6,4,Parent.Height*0.6,Parent.Height*0.6)
            Image: =User().Image
            RadiusBottomLeft: =40
            RadiusBottomRight: =40
            RadiusTopLeft: =40
            RadiusTopRight: =40
            Width: =Parent.Width*0.5
            ZIndex: =1

        Label1_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Courier New'
            FontWeight: =FontWeight.Bold
            Height: =Parent.Height*0.28
            Size: =If(RedemptionScreen.Size=1,15,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
            Text: =User().FullName
            Width: =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,300,320)
            ZIndex: =2

    RedemptionBodyContainer As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Parent.Height*0.7
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =5
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =20
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =10
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Width: =Parent.Width*0.9
        X: =(Parent.Width-Self.Width)/2
        Y: =(Parent.Height-Self.Height)/1.5
        ZIndex: =3

        SubCN_2 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(214, 223, 238, 1)
            FillPortions: =0
            Height: =Parent.Height/7
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =If(RedemptionScreen.Size=4,2,If(RedemptionScreen.Size=2,2,2))
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.Width*0.2
            ZIndex: =1

            Label8_11 As label:
                Align: =Align.Right
                FontWeight: =FontWeight.Bold
                Height: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                OnSelect: |
                    =false
                Size: =If(RedemptionScreen.Size=1,14,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
                Text: |-
                    ="Your Points:"
                Width: |
                    =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,170,180)
                ZIndex: =4

            Label8_12 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                Size: =If(RedemptionScreen.Size=1,14,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
                Text: =LookUp('Nominee List', 'Nominee Name'=User().FullName,Points)
                Width: |
                    =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,120,180)
                ZIndex: =5

        SubCN As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =RGBA(209, 232, 178, 1)
            FillPortions: =0
            Height: =Parent.Height/7
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =If(RedemptionScreen.Size=4,140,If(RedemptionScreen.Size=2,40,80))
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            Width: =Parent.Width*0.2
            ZIndex: =2

            Label8_2 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                Size: =If(RedemptionScreen.Size=1,15,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
                Text: ="Gifts"
                Width: |
                    =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,120,180)
                ZIndex: =2

            Label8_3 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                Size: =If(RedemptionScreen.Size=1,15,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
                Text: ="Points"
                Width: |
                    =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,120,180)
                ZIndex: =3

            Label8_6 As label:
                Align: =Align.Center
                FontWeight: =FontWeight.Bold
                Height: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                Size: =If(RedemptionScreen.Size=1,20,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                Text: =""
                Width: |
                    =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2||RedemptionScreen.Size=3,120,180)
                ZIndex: =4

        DataCN As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =Parent.Height/2
            LayoutGap: =If(RedemptionScreen.Size=4,150,If(RedemptionScreen.Size=2,50,100))
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            PaddingRight: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            ZIndex: =3

            Gallery1 As gallery.galleryVertical:
                DelayItemLoading: =true
                Fill: =RGBA(232, 244, 217, 1)
                Height: =Parent.Height-SubCN.Height
                Items: =PrizeList
                Layout: =Layout.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =70
                Width: =If(RedemptionScreen.Size=1,200,RedemptionScreen.Size=2||RedemptionScreen.Size=3,350,500)
                ZIndex: =1

                SubCN_1 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    Height: =Parent.Height/5
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutGap: =If(RedemptionScreen.Size=4,140,If(RedemptionScreen.Size=2,40,80))
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =5
                    Width: =Parent.TemplateWidth
                    X: =
                    ZIndex: =1

                    Label8_4 As label:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        Height: =If(RedemptionScreen.Size=1,40,RedemptionScreen.Size=2||RedemptionScreen.Size=3,70,25)
                        Size: =If(RedemptionScreen.Size=1,8,RedemptionScreen.Size=2||RedemptionScreen.Size=3,14,15)
                        Text: =ThisItem.Prize.Value
                        Width: =If(RedemptionScreen.Size=1,120,RedemptionScreen.Size=2,190,RedemptionScreen.Size=3,180,190)
                        X: =(Parent.Width-Self.Width)/2
                        Y: =(Parent.Height)
                        ZIndex: =1

                    Label8_5 As label:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        Height: =If(RedemptionScreen.Size=1,40,RedemptionScreen.Size=2||RedemptionScreen.Size=3,20,25)
                        Size: =If(RedemptionScreen.Size=1,8,RedemptionScreen.Size=2||RedemptionScreen.Size=3,15,15)
                        Text: =ThisItem.point
                        Width: =If(RedemptionScreen.Size=1,120,RedemptionScreen.Size=2,135,RedemptionScreen.Size=3,180,180)
                        X: =(Parent.Width-Self.Width)/2
                        ZIndex: =2

                    Button12 As button:
                        AlignInContainer: =AlignInContainer.Center
                        DisplayMode: =If(LookUp('Nominee List', 'Nominee Name'=User().FullName).Points>= ThisItem.point,DisplayMode.Edit,DisplayMode.Disabled)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =
                            ClearCollect(col_val, LookUp('Nominee List', 'Nominee Name'=User().FullName).Redeemed);
                            Collect(col_val,Defaults(col_val),{Value:ThisItem.Prize.Value});
                            
                            
                            If(
                                LookUp('Nominee List', 'Nominee Name' = User().FullName).Points >= ThisItem.point,
                                // If the user has enough points to redeem the gift
                                Patch(
                                    'Nominee List',
                                    LookUp('Nominee List', 'Nominee Name' = User().FullName),
                                    { 
                                        Points: LookUp('Nominee List', 'Nominee Name' = User().FullName).Points - ThisItem.point,
                                        Redeemed:col_val
                                          
                            
                                    }
                                );
                                  
                               
                                // Deduct the points from the user's points
                               Collect(
                                    RedeemedPrizes,
                                    { 'Nominee Name': User().FullName, Redeemed: ThisItem.Prize }
                                );
                                 // Add the redeemed gift to the RedeemedPrizes collection
                                 Office365Outlook.SendEmail(
                                    User().Email,
                                    "Gift Redeemed Successfully",
                                    "Congratulations! You have successfully redeemed the gift: " & ThisItem.Prize.Value
                                );
                               
                                Notify("Gift redeemed successfully", NotificationType.Success)
                                // Show a success message   
                            
                            
                            )
                        Size: =If(RedemptionScreen.Size=1,10,RedemptionScreen.Size=2,12,RedemptionScreen.Size=3,14,14)
                        Text: ="Redeem"
                        Width: =If(RedemptionScreen.Size=1,Parent.Width/3,RedemptionScreen.Size=2,90,RedemptionScreen.Size=3,110,180)
                        ZIndex: =3

